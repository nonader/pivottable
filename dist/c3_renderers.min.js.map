{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","makeC3Chart","chartOpts","pivotData","opts","agg","base","base1","base2","colKey","colKeys","columns","dataArray","datum","defaults","fullAggName","groupByTitle","h","hAxisTitle","headers","i","j","k","len","len1","len2","numCharsInHAxis","params","ref","renderArea","result","rotationAngle","row","rowHeader","rowKey","rowKeys","title","titleText","tree2","vAxisTitle","val","x","y","localeStrings","vs","by","c3","extend","size","width","window","innerWidth","height","innerHeight","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","colAttrs","rowAttrs","tree","parseFloat","format","value","getAggregator","isNumeric","toPrecision","toFixed","style","text","axis","label","tick","rotate","multiline","data","tooltip","grouped","fit","json","keys","legend","show","name","a","b","c","d","categories","stacked","groups","l","len3","appendTo","bindto","generate","detach","remove","append","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\r\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\r\n        pivotModule require(\"jquery\")\r\n    else if typeof define is \"function\" and define.amd # AMD\r\n        define [\"jquery\"], pivotModule\r\n    # Plain browser env\r\n    else\r\n        pivotModule jQuery\r\n        \r\ncallWithJQuery ($) ->\r\n\r\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\r\n        defaults =\r\n            localeStrings:\r\n                vs: \"vs\"\r\n                by: \"by\"\r\n            c3: {}\r\n\r\n        opts = $.extend true, defaults, opts\r\n        opts.c3.size ?= {}\r\n        opts.c3.size.width ?= window.innerWidth / 1.4\r\n        opts.c3.size.height ?= window.innerHeight / 1.4 - 50\r\n        chartOpts.type ?= \"line\"\r\n\r\n        rowKeys = pivotData.getRowKeys()\r\n        rowKeys.push [] if rowKeys.length == 0\r\n        colKeys = pivotData.getColKeys()\r\n        colKeys.push [] if colKeys.length == 0\r\n\r\n        headers = (h.join(\"-\") for h in colKeys)\r\n        rotationAngle = 0\r\n\r\n        fullAggName = pivotData.aggregatorName \r\n        if pivotData.valAttrs.length\r\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\r\n\r\n        if chartOpts.type == \"scatter\"\r\n            dataArray = []\r\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\r\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\r\n            for y, tree2 of pivotData.tree\r\n                for x, agg of tree2\r\n                    datum = {}\r\n                    datum[hAxisTitle] = parseFloat(x)\r\n                    datum[vAxisTitle] = parseFloat(y)\r\n                    datum[\"tooltip\"] = agg.format(agg.value())\r\n                    dataArray.push datum\r\n        else\r\n            numCharsInHAxis = 0\r\n            for x in headers\r\n                numCharsInHAxis += x.length\r\n            if numCharsInHAxis > 50\r\n                rotationAngle = 45\r\n\r\n            columns = []\r\n            for rowKey in rowKeys\r\n                rowHeader = rowKey.join(\"-\")\r\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\r\n                for colKey in colKeys\r\n                    agg = pivotData.getAggregator(rowKey, colKey)\r\n                    if agg.value()?\r\n                        val = agg.value()\r\n                        if $.isNumeric val\r\n                            if val < 1\r\n                                row.push parseFloat(val.toPrecision(3))\r\n                            else\r\n                                row.push parseFloat(val.toFixed(3))\r\n                        else\r\n                            row.push val\r\n\r\n                    else row.push null\r\n                columns.push row\r\n\r\n            vAxisTitle = pivotData.aggregatorName+ \r\n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\r\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\r\n\r\n        titleText = vAxisTitle = fullAggName\r\n        titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\r\n        groupByTitle = pivotData.rowAttrs.join(\"-\")\r\n        titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\r\n        title = $(\"<p>\", {style: \"text-align: center; font-weight: bold\"})\r\n        title.text(titleText)\r\n\r\n        params = \r\n            axis: \r\n                y:\r\n                    label: vAxisTitle\r\n                x:\r\n                    label: hAxisTitle\r\n                    tick:\r\n                        rotate: rotationAngle\r\n                        multiline: false\r\n            data: \r\n                type: chartOpts.type\r\n            tooltip:\r\n                grouped: false\r\n\r\n        $.extend params, opts.c3\r\n\r\n        if chartOpts.type == \"scatter\"\r\n            params.data.x = hAxisTitle\r\n            params.axis.x.tick = fit: false\r\n            params.data.json = dataArray\r\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\r\n            params.legend = show: false \r\n            params.tooltip.format =  \r\n                title: -> fullAggName\r\n                name: -> \"\"\r\n                value: (a,b,c,d) -> dataArray[d].tooltip\r\n        else\r\n            params.axis.x.type= 'category'\r\n            params.axis.x.categories = headers\r\n            params.data.columns = columns\r\n\r\n\r\n        if chartOpts.stacked?\r\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\r\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\r\n        result = $(\"<div>\").appendTo renderArea\r\n        params.bindto = result[0]\r\n        c3.generate params\r\n        result.detach()\r\n        renderArea.remove()\r\n        return $(\"<div>\").append title, result\r\n\r\n    $.pivotUtilities.c3_renderers = \r\n        \"Line Chart\": makeC3Chart()\r\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\r\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\r\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\r\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\r\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\")):\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)})(function(t){var e;return e=function(e){return null==e&&(e={}),function(r,n){var a,o,i,l,s,u,c,p,g,d,h,f,y,v,j,x,b,m,w,A,k,C,F,S,z,N,q,B,K,T,H,L,P,Q,R,U,W,_;if(d={localeStrings:{vs:\"vs\",by:\"by\"},c3:{}},n=t.extend(!0,d,n),null==(o=n.c3).size&&(o.size={}),null==(i=n.c3.size).width&&(i.width=window.innerWidth/1.4),null==(l=n.c3.size).height&&(l.height=window.innerHeight/1.4-50),null==e.type&&(e.type=\"line\"),H=r.getRowKeys(),0===H.length&&H.push([]),u=r.getColKeys(),0===u.length&&u.push([]),j=function(){var t,e,r;for(r=[],t=0,e=u.length;e>t;t++)y=u[t],r.push(y.join(\"-\"));return r}(),q=0,h=r.aggregatorName,r.valAttrs.length&&(h+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===e.type){p=[],v=r.colAttrs.join(\"-\"),R=r.rowAttrs.join(\"-\"),S=r.tree;for(_ in S){Q=S[_];for(W in Q)a=Q[W],g={},g[v]=parseFloat(W),g[R]=parseFloat(_),g.tooltip=a.format(a.value()),p.push(g)}}else{for(C=0,x=0,w=j.length;w>x;x++)W=j[x],C+=W.length;for(C>50&&(q=45),c=[],b=0,A=H.length;A>b;b++){for(T=H[b],K=T.join(\"-\"),B=[\"\"===K?r.aggregatorName:K],m=0,k=u.length;k>m;m++)s=u[m],a=r.getAggregator(T,s),null!=a.value()?(U=a.value(),B.push(t.isNumeric(U)?1>U?parseFloat(U.toPrecision(3)):parseFloat(U.toFixed(3)):U)):B.push(null);c.push(B)}R=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),v=r.colAttrs.join(\"-\")}return P=R=h,\"\"!==v&&(P+=\" \"+n.localeStrings.vs+\" \"+v),f=r.rowAttrs.join(\"-\"),\"\"!==f&&(P+=\" \"+n.localeStrings.by+\" \"+f),L=t(\"<p>\",{style:\"text-align: center; font-weight: bold\"}),L.text(P),F={axis:{y:{label:R},x:{label:v,tick:{rotate:q,multiline:!1}}},data:{type:e.type},tooltip:{grouped:!1}},t.extend(F,n.c3),\"scatter\"===e.type?(F.data.x=v,F.axis.x.tick={fit:!1},F.data.json=p,F.data.keys={value:[v,R]},F.legend={show:!1},F.tooltip.format={title:function(){return h},name:function(){return\"\"},value:function(t,e,r,n){return p[n].tooltip}}):(F.axis.x.type=\"category\",F.axis.x.categories=j,F.data.columns=c),null!=e.stacked&&(F.data.groups=[function(){var t,e,r;for(r=[],t=0,e=H.length;e>t;t++)W=H[t],r.push(W.join(\"-\"));return r}()]),z=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),N=t(\"<div>\").appendTo(z),F.bindto=N[0],c3.generate(F),N.detach(),z.remove(),t(\"<div>\").append(L,N)}},t.pivotUtilities.c3_renderers={\"Line Chart\":e(),\"Bar Chart\":e({type:\"bar\"}),\"Stacked Bar Chart\":e({type:\"bar\",stacked:!0}),\"Area Chart\":e({type:\"area\",stacked:!0}),\"Scatter Chart\":e({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}